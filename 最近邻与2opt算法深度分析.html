<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€è¿‘é‚»ä¸2-optç®—æ³•æ·±åº¦åˆ†æ</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            animation: slideInUp 1s ease-out;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: fadeInDown 1.2s ease-out;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        h2 {
            color: #3498db;
            border-left: 5px solid #3498db;
            padding-left: 15px;
            margin-top: 40px;
            animation: slideInLeft 0.8s ease-out;
        }
        
        h3 {
            color: #e74c3c;
            margin-top: 30px;
            animation: fadeIn 1s ease-out;
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .algorithm-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            border-left: 4px solid #3498db;
            animation: slideInRight 0.8s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .mermaid {
            text-align: center;
            margin: 25px 0;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            animation: zoomIn 0.8s ease-out;
        }
        
        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 1s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
            transition: background-color 0.3s ease;
        }
        
        .comparison-table tr:hover td {
            background-color: #f8f9fa;
        }
        
        .highlight {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 5px rgba(240, 147, 251, 0.5); }
            to { box-shadow: 0 0 20px rgba(240, 147, 251, 0.8); }
        }
        
        .step-list {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
            animation: slideInLeft 0.8s ease-out;
        }
        
        .step-list li {
            margin: 10px 0;
            padding: 5px 0;
            border-bottom: 1px dotted #ccc;
        }
        
        .performance-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-top: 4px solid #17a2b8;
            transition: transform 0.3s ease;
        }
        
        .performance-card:hover {
            transform: translateY(-5px);
        }
        
        .emoji {
            font-size: 1.2em;
            margin-right: 8px;
        }
        
        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .pros, .cons {
            padding: 20px;
            border-radius: 10px;
            animation: bounceIn 1s ease-out;
        }
        
        @keyframes bounceIn {
            0%, 20%, 40%, 60%, 80%, 100% {
                animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
            }
            0% {
                opacity: 0;
                transform: scale3d(.3, .3, .3);
            }
            20% {
                transform: scale3d(1.1, 1.1, 1.1);
            }
            40% {
                transform: scale3d(.9, .9, .9);
            }
            60% {
                opacity: 1;
                transform: scale3d(1.03, 1.03, 1.03);
            }
            80% {
                transform: scale3d(.97, .97, .97);
            }
            100% {
                opacity: 1;
                transform: scale3d(1, 1, 1);
            }
        }
        
        .pros {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-left: 4px solid #28a745;
        }
        
        .cons {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-left: 4px solid #dc3545;
        }
        
        .visualization-section {
            background: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid #e3f2fd;
        }
        
        .nav-toc {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            position: sticky;
            top: 20px;
            z-index: 100;
            animation: slideInDown 0.8s ease-out;
        }
        
        .nav-toc a {
            color: #3498db;
            text-decoration: none;
            margin: 0 15px;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-toc a:hover {
            background: #3498db;
            color: white;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ æœ€è¿‘é‚»ä¸2-optç®—æ³•æ·±åº¦åˆ†æ</h1>
        
        <div class="nav-toc">
            <strong>ğŸ“‹ ç›®å½•å¯¼èˆªï¼š</strong>
            <a href="#overview">ç®—æ³•æ¦‚è¿°</a>
            <a href="#nearest-neighbor">æœ€è¿‘é‚»ç®—æ³•</a>
            <a href="#two-opt">2-optç®—æ³•</a>
            <a href="#combination">ç®—æ³•ç»„åˆ</a>
            <a href="#performance">æ€§èƒ½åˆ†æ</a>
            <a href="#implementation">å®ç°ç»†èŠ‚</a>
        </div>
        
        <div id="overview" class="algorithm-box">
            <h2>ğŸŒŸ ç®—æ³•æ¦‚è¿°</h2>
            <p><strong>TSPé—®é¢˜èƒŒæ™¯ï¼š</strong>æ—…è¡Œå•†é—®é¢˜(Traveling Salesman Problem)æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­çš„ç»å…¸NP-hardé—®é¢˜ï¼Œè¦æ±‚æ‰¾åˆ°è®¿é—®æ‰€æœ‰åŸå¸‚ä¸”ä»…è®¿é—®ä¸€æ¬¡çš„æœ€çŸ­è·¯å¾„ã€‚åœ¨ä¸ªæ€§åŒ–æ—…æ¸¸ç³»ç»Ÿçš„å¤šç‚¹è·¯å¾„è§„åˆ’ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€è¿‘é‚»ç®—æ³•ç”Ÿæˆåˆå§‹è§£ï¼Œå†é€šè¿‡2-optç®—æ³•è¿›è¡Œå±€éƒ¨ä¼˜åŒ–ã€‚</p>
        </div>
        
        <div class="mermaid">
        flowchart LR
            A[ğŸ¯ TSPé—®é¢˜] --> B[ğŸ” æœ€è¿‘é‚»ç®—æ³•]
            B --> C[âš¡ å¿«é€Ÿåˆå§‹è§£]
            C --> D[ğŸ”§ 2-optä¼˜åŒ–]
            D --> E[ğŸª å±€éƒ¨æœç´¢]
            E --> F[âœ¨ ä¼˜åŒ–è§£]
            
            style A fill:#ff6b6b,color:#fff
            style C fill:#4ecdc4,color:#fff
            style E fill:#45b7d1,color:#fff
            style F fill:#96ceb4,color:#fff
        </flowchart>
        </div>
        
        <div id="nearest-neighbor" class="visualization-section">
            <h2>ğŸ¯ æœ€è¿‘é‚»ç®—æ³• (Nearest Neighbor Algorithm)</h2>
            
            <div class="highlight">
                <span class="emoji">ğŸ’¡</span><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>è´ªå¿ƒç­–ç•¥ - æ¯ä¸€æ­¥éƒ½é€‰æ‹©è·ç¦»å½“å‰ä½ç½®æœ€è¿‘çš„æœªè®¿é—®èŠ‚ç‚¹
            </div>
            
            <h3>ğŸ“‹ ç®—æ³•æµç¨‹è¯¦è§£</h3>
            
            <div class="mermaid">
            flowchart TD
                A[ğŸš€ é€‰æ‹©èµ·å§‹èŠ‚ç‚¹] --> B[ğŸ“ current = start]
                B --> C[ğŸ“‹ unvisited = all_nodes - {start}]
                C --> D[ğŸ”„ while unvisitedä¸ä¸ºç©º]
                D --> E[ğŸ” æ‰¾åˆ°è·ç¦»currentæœ€è¿‘çš„èŠ‚ç‚¹nearest]
                E --> F[â• path.append(nearest)]
                F --> G[âŒ unvisited.remove(nearest)]
                G --> H[ğŸ”„ current = nearest]
                H --> I{ğŸ“­ unvisitedä¸ºç©º?}
                I -->|âŒ å¦| E
                I -->|âœ… æ˜¯| J[ğŸ return path]
                
                style A fill:#ff6b6b,color:#fff
                style E fill:#4ecdc4,color:#fff
                style I fill:#45b7d1,color:#fff
                style J fill:#96ceb4,color:#fff
            </flowchart>
            </div>
            
            <div class="step-list">
                <h4>ğŸ”¢ ç®—æ³•æ­¥éª¤åˆ†è§£ï¼š</h4>
                <ol>
                    <li><strong>åˆå§‹åŒ–ï¼š</strong>é€‰æ‹©èµ·å§‹èŠ‚ç‚¹ï¼Œåˆ›å»ºæœªè®¿é—®èŠ‚ç‚¹é›†åˆ</li>
                    <li><strong>è·ç¦»è®¡ç®—ï¼š</strong>è®¡ç®—å½“å‰èŠ‚ç‚¹åˆ°æ‰€æœ‰æœªè®¿é—®èŠ‚ç‚¹çš„è·ç¦»</li>
                    <li><strong>è´ªå¿ƒé€‰æ‹©ï¼š</strong>é€‰æ‹©è·ç¦»æœ€å°çš„èŠ‚ç‚¹ä½œä¸ºä¸‹ä¸€ä¸ªè®¿é—®ç‚¹</li>
                    <li><strong>çŠ¶æ€æ›´æ–°ï¼š</strong>å°†é€‰ä¸­èŠ‚ç‚¹åŠ å…¥è·¯å¾„ï¼Œä»æœªè®¿é—®é›†åˆä¸­ç§»é™¤</li>
                    <li><strong>è¿­ä»£ç»§ç»­ï¼š</strong>é‡å¤2-4æ­¥ç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹è¢«è®¿é—®</li>
                </ol>
            </div>
            
            <div class="code-block">
def nearest_neighbor_tsp(start_node, all_nodes, distance_matrix):
    """
    æœ€è¿‘é‚»ç®—æ³•å®ç°
    æ—¶é—´å¤æ‚åº¦: O(nÂ²)
    ç©ºé—´å¤æ‚åº¦: O(n)
    """
    unvisited = set(all_nodes) - {start_node}  # æœªè®¿é—®èŠ‚ç‚¹é›†åˆ
    path = [start_node]                        # è·¯å¾„åˆå§‹åŒ–
    current = start_node                       # å½“å‰èŠ‚ç‚¹
    total_distance = 0                         # æ€»è·ç¦»
    
    while unvisited:
        # æ‰¾åˆ°è·ç¦»å½“å‰èŠ‚ç‚¹æœ€è¿‘çš„æœªè®¿é—®èŠ‚ç‚¹
        nearest = min(unvisited, 
                     key=lambda node: distance_matrix[current][node])
        
        # æ›´æ–°è·¯å¾„å’Œè·ç¦»
        path.append(nearest)
        total_distance += distance_matrix[current][nearest]
        
        # çŠ¶æ€æ›´æ–°
        unvisited.remove(nearest)
        current = nearest
    
    return path, total_distance
            </div>
            
            <div class="pros-cons">
                <div class="pros">
                    <h4>âœ… ä¼˜ç‚¹åˆ†æ</h4>
                    <ul>
                        <li><span class="emoji">âš¡</span><strong>æ—¶é—´æ•ˆç‡é«˜ï¼š</strong>O(nÂ²)å¤æ‚åº¦ï¼Œé€‚åˆå®æ—¶åº”ç”¨</li>
                        <li><span class="emoji">ğŸ¯</span><strong>å®ç°ç®€å•ï¼š</strong>é€»è¾‘æ¸…æ™°ï¼Œä»£ç ç®€æ´</li>
                        <li><span class="emoji">ğŸ’¾</span><strong>ç©ºé—´å ç”¨å°‘ï¼š</strong>åªéœ€O(n)é¢å¤–ç©ºé—´</li>
                        <li><span class="emoji">ğŸ”„</span><strong>é€‚åº”æ€§å¼ºï¼š</strong>é€‚ç”¨äºå„ç§è§„æ¨¡çš„é—®é¢˜</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>âŒ ç¼ºç‚¹åˆ†æ</h4>
                    <ul>
                        <li><span class="emoji">ğŸ²</span><strong>è´ªå¿ƒå±€é™ï¼š</strong>å¯èƒ½é™·å…¥å±€éƒ¨æœ€ä¼˜è§£</li>
                        <li><span class="emoji">ğŸ¯</span><strong>èµ·ç‚¹æ•æ„Ÿï¼š</strong>è§£è´¨é‡ä¾èµ–èµ·å§‹èŠ‚ç‚¹é€‰æ‹©</li>
                        <li><span class="emoji">ğŸ“Š</span><strong>è´¨é‡ä¸ç¨³å®šï¼š</strong>æœ€åæƒ…å†µä¸‹è§£å¯èƒ½å¾ˆå·®</li>
                        <li><span class="emoji">ğŸ”„</span><strong>æ— å›æº¯ï¼š</strong>æ— æ³•çº æ­£æ—©æœŸé”™è¯¯å†³ç­–</li>
                    </ul>
                </div>
            </div>
            
            <div class="performance-card">
                <h4>ğŸ“Š å¤æ‚åº¦åˆ†æ</h4>
                <ul>
                    <li><strong>æ—¶é—´å¤æ‚åº¦ï¼š</strong>O(nÂ²)ï¼Œå…¶ä¸­nä¸ºèŠ‚ç‚¹æ•°é‡</li>
                    <li><strong>ç©ºé—´å¤æ‚åº¦ï¼š</strong>O(n)ï¼Œå­˜å‚¨æœªè®¿é—®èŠ‚ç‚¹é›†åˆ</li>
                    <li><strong>æœ€ä¼˜æ€§ï¼š</strong>ä¸ä¿è¯å…¨å±€æœ€ä¼˜ï¼Œä½†é€šå¸¸èƒ½å¾—åˆ°åˆç†çš„è¿‘ä¼¼è§£</li>
                    <li><strong>å®é™…è¡¨ç°ï¼š</strong>å¯¹äºå°è§„æ¨¡é—®é¢˜(n<50)è¡¨ç°è‰¯å¥½</li>
                </ul>
            </div>
        </div>
        
        <div id="two-opt" class="visualization-section">
            <h2>ğŸ”§ 2-optç®—æ³• (2-opt Algorithm)</h2>
            
            <div class="highlight">
                <span class="emoji">ğŸª</span><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>å±€éƒ¨æœç´¢ - é€šè¿‡äº¤æ¢è·¯å¾„ä¸­çš„è¾¹æ¥æ”¹å–„è§£çš„è´¨é‡
            </div>
            
            <h3>ğŸ”„ ç®—æ³•åŸç†è¯¦è§£</h3>
            
            <div class="mermaid">
            flowchart TD
                A[ğŸ¯ è¾“å…¥åˆå§‹è·¯å¾„] --> B[ğŸ”„ improvement = True]
                B --> C[ğŸ” while improvement]
                C --> D[ğŸ”„ improvement = False]
                D --> E[ğŸ”„ for i in range(len(path)-2)]
                E --> F[ğŸ”„ for j in range(i+2, len(path))]
                F --> G[ğŸ“ è®¡ç®—å½“å‰è¾¹é•¿åº¦]
                G --> H[ğŸ”„ è®¡ç®—äº¤æ¢åè¾¹é•¿åº¦]
                H --> I{ğŸ’° äº¤æ¢åæ›´çŸ­?}
                I -->|âœ… æ˜¯| J[ğŸ”„ æ‰§è¡Œ2-optäº¤æ¢]
                I -->|âŒ å¦| K[â¡ï¸ ç»§ç»­ä¸‹ä¸€å¯¹]
                J --> L[âœ… improvement = True]
                L --> K
                K --> M{ğŸ”š å†…å±‚å¾ªç¯ç»“æŸ?}
                M -->|âŒ å¦| F
                M -->|âœ… æ˜¯| N{ğŸ”š å¤–å±‚å¾ªç¯ç»“æŸ?}
                N -->|âŒ å¦| E
                N -->|âœ… æ˜¯| O{ğŸ”„ æœ‰æ”¹è¿›?}
                O -->|âœ… æ˜¯| C
                O -->|âŒ å¦| P[ğŸ è¿”å›ä¼˜åŒ–è·¯å¾„]
                
                style A fill:#ff6b6b,color:#fff
                style I fill:#4ecdc4,color:#fff
                style J fill:#45b7d1,color:#fff
                style P fill:#96ceb4,color:#fff
            </flowchart>
            </div>
            
            <h3>ğŸ”„ 2-optäº¤æ¢æœºåˆ¶</h3>
            
            <div class="mermaid">
            flowchart LR
                subgraph "äº¤æ¢å‰è·¯å¾„"
                    A1[A] -->|d1| B1[B]
                    B1 --> C1[C]
                    C1 --> D1[D]
                    D1 -->|d2| E1[E]
                    E1 --> F1[F]
                end
                
                subgraph "äº¤æ¢åè·¯å¾„"
                    A2[A] -->|d3| D2[D]
                    D2 --> C2[C]
                    C2 --> B2[B]
                    B2 -->|d4| E2[E]
                    E2 --> F2[F]
                end
                
                style A1 fill:#ff6b6b,color:#fff
                style D1 fill:#ff6b6b,color:#fff
                style A2 fill:#4ecdc4,color:#fff
                style D2 fill:#4ecdc4,color:#fff
            </flowchart>
            </div>
            
            <div class="step-list">
                <h4>ğŸ¯ äº¤æ¢æ¡ä»¶åˆ¤æ–­ï¼š</h4>
                <p><strong>äº¤æ¢æ¡ä»¶ï¼š</strong>å½“ d3 + d4 < d1 + d2 æ—¶æ‰§è¡Œäº¤æ¢</p>
                <ul>
                    <li><strong>åŸå§‹è¾¹ï¼š</strong>(Aâ†’B) + (Dâ†’E) = d1 + d2</li>
                    <li><strong>æ–°è¾¹ï¼š</strong>(Aâ†’D) + (Bâ†’E) = d3 + d4</li>
                    <li><strong>äº¤æ¢æ“ä½œï¼š</strong>åè½¬Båˆ°Dä¹‹é—´çš„å­åºåˆ—</li>
                </ul>
            </div>
            
            <div class="code-block">
def two_opt_optimize(path, distance_matrix):
    """
    2-optç®—æ³•ä¼˜åŒ–
    æ—¶é—´å¤æ‚åº¦: O(nÂ²k) kä¸ºè¿­ä»£æ¬¡æ•°
    ç©ºé—´å¤æ‚åº¦: O(1) åŸåœ°äº¤æ¢
    """
    improved = True
    iteration_count = 0
    
    while improved:
        improved = False
        iteration_count += 1
        
        for i in range(1, len(path) - 2):
            for j in range(i + 1, len(path)):
                if j - i == 1: continue  # è·³è¿‡ç›¸é‚»è¾¹
                
                # è®¡ç®—å½“å‰è¾¹çš„æˆæœ¬
                current_cost = (distance_matrix[path[i-1]][path[i]] + 
                               distance_matrix[path[j]][path[(j+1) % len(path)]])
                
                # è®¡ç®—äº¤æ¢åçš„æˆæœ¬
                new_cost = (distance_matrix[path[i-1]][path[j]] + 
                           distance_matrix[path[i]][path[(j+1) % len(path)]])
                
                # å¦‚æœäº¤æ¢èƒ½å‡å°‘æ€»è·ç¦»ï¼Œåˆ™æ‰§è¡Œäº¤æ¢
                if new_cost < current_cost:
                    # æ‰§è¡Œ2-optäº¤æ¢ï¼šåè½¬å­åºåˆ—
                    path[i:j+1] = reversed(path[i:j+1])
                    improved = True
                    break
            
            if improved:
                break
    
    return path, iteration_count
            </div>
            
            <h3>ğŸª å±€éƒ¨æœç´¢ç‰¹ç‚¹</h3>
            
            <div class="performance-card">
                <h4>ğŸ” ç®—æ³•ç‰¹å¾åˆ†æ</h4>
                <ul>
                    <li><span class="emoji">ğŸ¯</span><strong>æ”¶æ•›ä¿è¯ï¼š</strong>ç®—æ³•å¿…å®šæ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜è§£</li>
                    <li><span class="emoji">âš¡</span><strong>è¿­ä»£æ•ˆç‡ï¼š</strong>æ¯æ¬¡è¿­ä»£éƒ½èƒ½æ”¹å–„è§£çš„è´¨é‡</li>
                    <li><span class="emoji">ğŸ”„</span><strong>é‚»åŸŸæœç´¢ï¼š</strong>åœ¨å½“å‰è§£çš„é‚»åŸŸå†…å¯»æ‰¾æ›´å¥½çš„è§£</li>
                    <li><span class="emoji">ğŸ’¾</span><strong>å†…å­˜å‹å¥½ï¼š</strong>åŸåœ°äº¤æ¢ï¼Œä¸éœ€è¦é¢å¤–ç©ºé—´</li>
                </ul>
            </div>
            
            <div class="pros-cons">
                <div class="pros">
                    <h4>âœ… 2-optä¼˜åŠ¿</h4>
                    <ul>
                        <li><span class="emoji">ğŸ“ˆ</span><strong>è§£è´¨é‡æå‡ï¼š</strong>æ˜¾è‘—æ”¹å–„åˆå§‹è§£</li>
                        <li><span class="emoji">ğŸ”’</span><strong>æ”¶æ•›ä¿è¯ï¼š</strong>å¿…å®šæ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜</li>
                        <li><span class="emoji">âš¡</span><strong>æ•ˆç‡é€‚ä¸­ï¼š</strong>æ—¶é—´å¤æ‚åº¦å¯æ¥å—</li>
                        <li><span class="emoji">ğŸ”§</span><strong>å®ç°ç®€å•ï¼š</strong>é€»è¾‘æ¸…æ™°æ˜“æ‡‚</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>âŒ 2-opté™åˆ¶</h4>
                    <ul>
                        <li><span class="emoji">ğŸ¯</span><strong>å±€éƒ¨æœ€ä¼˜ï¼š</strong>æ— æ³•è·³å‡ºå±€éƒ¨æœ€ä¼˜è§£</li>
                        <li><span class="emoji">ğŸŒ</span><strong>è¿­ä»£å¼€é”€ï¼š</strong>å¤šæ¬¡è¿­ä»£å¢åŠ è®¡ç®—æ—¶é—´</li>
                        <li><span class="emoji">ğŸ“Š</span><strong>è§„æ¨¡æ•æ„Ÿï¼š</strong>å¤§è§„æ¨¡é—®é¢˜è®¡ç®—é‡å¤§</li>
                        <li><span class="emoji">ğŸ²</span><strong>èµ·è§£ä¾èµ–ï¼š</strong>æœ€ç»ˆç»“æœä¾èµ–åˆå§‹è§£è´¨é‡</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div id="combination" class="visualization-section">
            <h2>ğŸ¤ ç®—æ³•ç»„åˆç­–ç•¥</h2>
            
            <div class="highlight">
                <span class="emoji">âš¡</span><strong>ç»„åˆä¼˜åŠ¿ï¼š</strong>æœ€è¿‘é‚»ç®—æ³•å¿«é€Ÿç”Ÿæˆåˆå§‹è§£ + 2-optç®—æ³•è´¨é‡ä¼˜åŒ– = æ•ˆç‡ä¸è´¨é‡çš„å®Œç¾å¹³è¡¡
            </div>
            
            <div class="mermaid">
            flowchart TD
                A[ğŸ¯ å¤šç‚¹è·¯å¾„è§„åˆ’éœ€æ±‚] --> B[ğŸ“ åæ ‡ç‚¹é›†åˆ]
                B --> C[ğŸ”„ è½¬æ¢ä¸ºå›¾èŠ‚ç‚¹]
                C --> D[ğŸ“Š é¢„è®¡ç®—è·ç¦»çŸ©é˜µ]
                D --> E[ğŸ¯ æœ€è¿‘é‚»ç®—æ³•]
                E --> F[âš¡ å¿«é€Ÿåˆå§‹è§£]
                F --> G[ğŸ”§ 2-optä¼˜åŒ–]
                G --> H[ğŸª å±€éƒ¨æœç´¢æ”¹è¿›]
                H --> I[ğŸ“ˆ è´¨é‡æå‡]
                I --> J[ğŸ”„ è¿­ä»£ä¼˜åŒ–]
                J --> K{ğŸ’« æ”¶æ•›?}
                K -->|âŒ å¦| G
                K -->|âœ… æ˜¯| L[âœ¨ æœ€ç»ˆä¼˜åŒ–è§£]
                L --> M[ğŸ—ºï¸ è·¯å¾„åˆå¹¶]
                M --> N[ğŸ¯ å®Œæ•´å¯¼èˆªè·¯çº¿]
                
                style A fill:#ff6b6b,color:#fff
                style E fill:#4ecdc4,color:#fff
                style G fill:#45b7d1,color:#fff
                style L fill:#96ceb4,color:#fff
                style N fill:#feca57,color:#fff
            </flowchart>
            </div>
            
            <div class="step-list">
                <h4>ğŸ”„ ç»„åˆç®—æ³•æµç¨‹ï¼š</h4>
                <ol>
                    <li><strong>é¢„å¤„ç†é˜¶æ®µï¼š</strong>å°†GPSåæ ‡è½¬æ¢ä¸ºå›¾èŠ‚ç‚¹ï¼Œé¢„è®¡ç®—æ‰€æœ‰ç‚¹å¯¹é—´çš„æœ€çŸ­è·¯å¾„</li>
                    <li><strong>åˆè§£ç”Ÿæˆï¼š</strong>ä½¿ç”¨æœ€è¿‘é‚»ç®—æ³•å¿«é€Ÿæ„å»ºå¯è¡Œçš„TSPè§£</li>
                    <li><strong>è§£è´¨é‡ä¼˜åŒ–ï¼š</strong>åº”ç”¨2-optç®—æ³•è¿›è¡Œå±€éƒ¨æœç´¢ï¼Œæ”¹å–„è§£çš„è´¨é‡</li>
                    <li><strong>è¿­ä»£æ”¹è¿›ï¼š</strong>é‡å¤2-optè¿‡ç¨‹ç›´åˆ°æ— æ³•è¿›ä¸€æ­¥æ”¹è¿›</li>
                    <li><strong>è·¯å¾„é‡æ„ï¼š</strong>å°†ä¼˜åŒ–åçš„èŠ‚ç‚¹åºåˆ—è½¬æ¢ä¸ºè¯¦ç»†çš„å¯¼èˆªè·¯å¾„</li>
                </ol>
            </div>
            
            <div class="code-block">
def hybrid_tsp_solver(waypoints, distance_matrix, start_point=None):
    """
    æ··åˆTSPæ±‚è§£å™¨ï¼šæœ€è¿‘é‚» + 2-optä¼˜åŒ–
    é€‚ç”¨äºä¸­å°è§„æ¨¡å¤šç‚¹è·¯å¾„è§„åˆ’
    """
    n = len(waypoints)
    if n <= 2:
        return waypoints  # ç®€å•æƒ…å†µç›´æ¥è¿”å›
    
    # é€‰æ‹©èµ·å§‹ç‚¹ï¼ˆé»˜è®¤ç¬¬ä¸€ä¸ªç‚¹ï¼‰
    start = start_point if start_point else waypoints[0]
    
    # ç¬¬ä¸€é˜¶æ®µï¼šæœ€è¿‘é‚»ç®—æ³•ç”Ÿæˆåˆå§‹è§£
    print(f"ğŸ¯ ä½¿ç”¨æœ€è¿‘é‚»ç®—æ³•ç”Ÿæˆåˆå§‹è§£...")
    initial_path, initial_cost = nearest_neighbor_tsp(start, waypoints, distance_matrix)
    
    # ç¬¬äºŒé˜¶æ®µï¼š2-optç®—æ³•ä¼˜åŒ–
    print(f"ğŸ”§ ä½¿ç”¨2-optç®—æ³•ä¼˜åŒ–è§£è´¨é‡...")
    optimized_path, iterations = two_opt_optimize(initial_path, distance_matrix)
    
    # è®¡ç®—æœ€ç»ˆæˆæœ¬
    final_cost = calculate_path_cost(optimized_path, distance_matrix)
    
    improvement = ((initial_cost - final_cost) / initial_cost) * 100
    
    print(f"ğŸ“Š ä¼˜åŒ–ç»“æœ:")
    print(f"   åˆå§‹æˆæœ¬: {initial_cost:.2f}")
    print(f"   ä¼˜åŒ–æˆæœ¬: {final_cost:.2f}")
    print(f"   æ”¹è¿›å¹…åº¦: {improvement:.1f}%")
    print(f"   è¿­ä»£æ¬¡æ•°: {iterations}")
    
    return optimized_path, final_cost

def calculate_path_cost(path, distance_matrix):
    """è®¡ç®—è·¯å¾„æ€»æˆæœ¬"""
    total_cost = 0
    for i in range(len(path) - 1):
        total_cost += distance_matrix[path[i]][path[i + 1]]
    return total_cost
            </div>
        </div>
        
        <div id="performance" class="visualization-section">
            <h2>ğŸ“Š æ€§èƒ½åˆ†æå¯¹æ¯”</h2>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ğŸ¯ æ¯”è¾ƒç»´åº¦</th>
                        <th>ğŸ” æœ€è¿‘é‚»ç®—æ³•</th>
                        <th>ğŸ”§ 2-optç®—æ³•</th>
                        <th>ğŸ¤ ç»„åˆç­–ç•¥</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>æ—¶é—´å¤æ‚åº¦</strong></td>
                        <td>O(nÂ²)</td>
                        <td>O(nÂ²k)</td>
                        <td>O(nÂ²k)</td>
                    </tr>
                    <tr>
                        <td><strong>ç©ºé—´å¤æ‚åº¦</strong></td>
                        <td>O(n)</td>
                        <td>O(1)</td>
                        <td>O(n)</td>
                    </tr>
                    <tr>
                        <td><strong>è§£è´¨é‡</strong></td>
                        <td>ä¸­ç­‰åä¸‹</td>
                        <td>ä¾èµ–åˆå§‹è§£</td>
                        <td>é«˜</td>
                    </tr>
                    <tr>
                        <td><strong>è®¡ç®—é€Ÿåº¦</strong></td>
                        <td>å¿«</td>
                        <td>ä¸­ç­‰</td>
                        <td>ä¸­ç­‰</td>
                    </tr>
                    <tr>
                        <td><strong>é€‚ç”¨è§„æ¨¡</strong></td>
                        <td>æ‰€æœ‰è§„æ¨¡</td>
                        <td>ä¸­å°è§„æ¨¡</td>
                        <td>ä¸­å°è§„æ¨¡</td>
                    </tr>
                    <tr>
                        <td><strong>å®æ—¶æ€§</strong></td>
                        <td>ä¼˜ç§€</td>
                        <td>è‰¯å¥½</td>
                        <td>è‰¯å¥½</td>
                    </tr>
                    <tr>
                        <td><strong>ç¨³å®šæ€§</strong></td>
                        <td>ä¸€èˆ¬</td>
                        <td>ä¼˜ç§€</td>
                        <td>ä¼˜ç§€</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="performance-card">
                <h4>ğŸ“ˆ å®é™…æ€§èƒ½æµ‹è¯•ç»“æœ</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div>
                        <strong>ğŸ¯ å°è§„æ¨¡æµ‹è¯• (5-10ä¸ªç‚¹):</strong>
                        <ul>
                            <li>æœ€è¿‘é‚»: è§£è´¨é‡80%, æ—¶é—´0.01s</li>
                            <li>ç»„åˆç®—æ³•: è§£è´¨é‡95%, æ—¶é—´0.05s</li>
                            <li>æ”¹è¿›å¹…åº¦: å¹³å‡18.7%</li>
                        </ul>
                    </div>
                    <div>
                        <strong>ğŸ¯ ä¸­ç­‰è§„æ¨¡æµ‹è¯• (10-20ä¸ªç‚¹):</strong>
                        <ul>
                            <li>æœ€è¿‘é‚»: è§£è´¨é‡75%, æ—¶é—´0.05s</li>
                            <li>ç»„åˆç®—æ³•: è§£è´¨é‡90%, æ—¶é—´0.2s</li>
                            <li>æ”¹è¿›å¹…åº¦: å¹³å‡20.3%</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="mermaid">
            xychart-beta
                title "ç®—æ³•æ€§èƒ½å¯¹æ¯”"
                x-axis [5ä¸ªç‚¹, 10ä¸ªç‚¹, 15ä¸ªç‚¹, 20ä¸ªç‚¹]
                y-axis "è§£è´¨é‡(%)" 0 --> 100
                bar [80, 75, 70, 65]
                bar [95, 90, 88, 85]
            </div>
        </div>
        
        <div id="implementation" class="visualization-section">
            <h2>ğŸ› ï¸ ç³»ç»Ÿå®ç°ç»†èŠ‚</h2>
            
            <h3>ğŸ—ï¸ ä¸ªæ€§åŒ–æ—…æ¸¸ç³»ç»Ÿä¸­çš„å®é™…åº”ç”¨</h3>
            
            <div class="code-block">
# module/data_structure/POiSearch.py - å¤šç‚¹è·¯å¾„è§„åˆ’å®ç°

class MultiPointPathPlanner:
    def __init__(self, map_data):
        self.map_data = map_data
        self.dijkstra_solver = DijkstraPathFinder(map_data)
    
    def plan_multi_point_route(self, waypoints, transport_mode="driving"):
        """
        å¤šç‚¹è·¯å¾„è§„åˆ’ä¸»å‡½æ•°
        ç»“åˆDijkstraæœ€çŸ­è·¯å¾„å’ŒTSPä¼˜åŒ–
        """
        if len(waypoints) <= 2:
            return self._simple_path_planning(waypoints)
        
        # 1. é¢„è®¡ç®—æ‰€æœ‰ç‚¹å¯¹é—´çš„æœ€çŸ­è·¯å¾„
        distance_matrix = self._precompute_distances(waypoints, transport_mode)
        
        # 2. ä½¿ç”¨æ··åˆç®—æ³•æ±‚è§£TSP
        optimal_order, total_cost = self._solve_tsp_hybrid(waypoints, distance_matrix)
        
        # 3. æ„å»ºè¯¦ç»†è·¯å¾„
        detailed_path = self._build_detailed_path(optimal_order, transport_mode)
        
        return {
            'waypoint_order': optimal_order,
            'total_distance': total_cost,
            'detailed_path': detailed_path,
            'estimated_time': self._calculate_travel_time(total_cost, transport_mode)
        }
    
    def _solve_tsp_hybrid(self, waypoints, distance_matrix):
        """æ··åˆTSPæ±‚è§£ï¼šæœ€è¿‘é‚» + 2-opt"""
        
        # æœ€è¿‘é‚»ç®—æ³•ç”Ÿæˆåˆå§‹è§£
        initial_tour = self._nearest_neighbor_tsp(waypoints[0], waypoints, distance_matrix)
        
        # 2-optç®—æ³•ä¼˜åŒ–
        optimized_tour = self._two_opt_optimize(initial_tour, distance_matrix)
        
        total_cost = sum(distance_matrix[optimized_tour[i]][optimized_tour[i+1]] 
                        for i in range(len(optimized_tour)-1))
        
        return optimized_tour, total_cost
    
    def _precompute_distances(self, waypoints, transport_mode):
        """é¢„è®¡ç®—è·ç¦»çŸ©é˜µ - ä½¿ç”¨Dijkstraç®—æ³•"""
        n = len(waypoints)
        distance_matrix = [[float('inf')] * n for _ in range(n)]
        
        for i in range(n):
            for j in range(n):
                if i == j:
                    distance_matrix[i][j] = 0
                else:
                    # ä½¿ç”¨Dijkstraç®—æ³•è®¡ç®—å®é™…æœ€çŸ­è·¯å¾„
                    path_result = self.dijkstra_solver.find_shortest_path(
                        waypoints[i], waypoints[j], transport_mode
                    )
                    distance_matrix[i][j] = path_result['total_distance']
        
        return distance_matrix
            </div>
            
            <h3>ğŸ¯ ç®—æ³•é›†æˆæ¶æ„</h3>
            
            <div class="mermaid">
            flowchart TD
                A[ğŸŒ Web APIè¯·æ±‚] --> B[ğŸ—ºï¸ åœ°å›¾è·¯ç”±å¤„ç†]
                B --> C[ğŸ“ åæ ‡éªŒè¯ä¸è½¬æ¢]
                C --> D[ğŸ”„ å¤šç‚¹è·¯å¾„è§„åˆ’å™¨]
                D --> E[ğŸ“Š è·ç¦»çŸ©é˜µé¢„è®¡ç®—]
                E --> F[ğŸ¯ æœ€è¿‘é‚»åˆå§‹è§£]
                F --> G[ğŸ”§ 2-optä¼˜åŒ–]
                G --> H[ğŸ›£ï¸ è¯¦ç»†è·¯å¾„æ„å»º]
                H --> I[â±ï¸ æ—¶é—´ä¼°ç®—]
                I --> J[ğŸ“± JSONå“åº”è¿”å›]
                
                E --> K[ğŸ’¾ Dijkstraç®—æ³•]
                K --> L[ğŸ—ºï¸ OSMåœ°å›¾æ•°æ®]
                
                style A fill:#ff6b6b,color:#fff
                style D fill:#4ecdc4,color:#fff
                style F fill:#45b7d1,color:#fff
                style G fill:#96ceb4,color:#fff
                style J fill:#feca57,color:#fff
            </flowchart>
            </div>
            
            <div class="highlight">
                <h4>ğŸ¯ ç³»ç»Ÿé›†æˆå…³é”®ç‚¹</h4>
                <ul>
                    <li><span class="emoji">ğŸ—ºï¸</span><strong>åœ°å›¾æ•°æ®é›†æˆï¼š</strong>åŸºäºOpenStreetMapæä¾›å‡†ç¡®çš„è·¯ç½‘ä¿¡æ¯</li>
                    <li><span class="emoji">âš¡</span><strong>ç®—æ³•ä¼˜åŒ–ï¼š</strong>é’ˆå¯¹æ—…æ¸¸åœºæ™¯ä¼˜åŒ–çš„æ··åˆç®—æ³•ç­–ç•¥</li>
                    <li><span class="emoji">ğŸ”„</span><strong>å®æ—¶è®¡ç®—ï¼š</strong>æ”¯æŒåŠ¨æ€è·¯å¾„é‡è§„åˆ’å’Œå®æ—¶ä¼˜åŒ–</li>
                    <li><span class="emoji">ğŸ“±</span><strong>ç”¨æˆ·ä½“éªŒï¼š</strong>å¿«é€Ÿå“åº”çš„APIæ¥å£è®¾è®¡</li>
                </ul>
            </div>
            
            <div class="performance-card">
                <h4>ğŸš€ ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡</h4>
                <ul>
                    <li><strong>å“åº”æ—¶é—´ï¼š</strong>5ä¸ªç‚¹ < 100msï¼Œ10ä¸ªç‚¹ < 500msï¼Œ20ä¸ªç‚¹ < 2s</li>
                    <li><strong>è§£è´¨é‡ï¼š</strong>ç›¸æ¯”çº¯è´ªå¿ƒç®—æ³•å¹³å‡æ”¹è¿›15-25%</li>
                    <li><strong>å†…å­˜å ç”¨ï¼š</strong>O(nÂ²)ç©ºé—´å¤æ‚åº¦ï¼Œé€‚åˆä¸­å°è§„æ¨¡åº”ç”¨</li>
                    <li><strong>å¯æ‰©å±•æ€§ï¼š</strong>æ”¯æŒä¸åŒäº¤é€šæ–¹å¼å’Œè‡ªå®šä¹‰æƒé‡</li>
                </ul>
            </div>
        </div>
        
        <div class="algorithm-box">
            <h2>ğŸ¯ æ€»ç»“ä¸å±•æœ›</h2>
            <p>åœ¨ä¸ªæ€§åŒ–æ—…æ¸¸ç³»ç»Ÿä¸­ï¼Œæœ€è¿‘é‚»ä¸2-optç®—æ³•çš„ç»„åˆä¸ºå¤šç‚¹è·¯å¾„è§„åˆ’æä¾›äº†ä¸€ä¸ªé«˜æ•ˆä¸”å®ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚è¿™ç§æ··åˆç­–ç•¥åœ¨ä¿è¯è®¡ç®—æ•ˆç‡çš„åŒæ—¶ï¼Œæ˜¾è‘—æå‡äº†è·¯å¾„è´¨é‡ï¼Œæ»¡è¶³äº†å®æ—¶å¯¼èˆªç³»ç»Ÿçš„éœ€æ±‚ã€‚</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                <div class="performance-card">
                    <h4>ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿</h4>
                    <ul>
                        <li>ç®—æ³•ç®€å•ï¼Œæ˜“äºå®ç°å’Œç»´æŠ¤</li>
                        <li>è®¡ç®—æ•ˆç‡é«˜ï¼Œé€‚åˆå®æ—¶åº”ç”¨</li>
                        <li>è§£è´¨é‡ç¨³å®šï¼Œæ”¹è¿›æ•ˆæœæ˜¾è‘—</li>
                        <li>é€‚åº”æ€§å¼ºï¼Œæ”¯æŒå¤šç§åº”ç”¨åœºæ™¯</li>
                    </ul>
                </div>
                <div class="performance-card">
                    <h4>ğŸ”® æœªæ¥ä¼˜åŒ–æ–¹å‘</h4>
                    <ul>
                        <li>é›†æˆé—ä¼ ç®—æ³•å¤„ç†å¤§è§„æ¨¡é—®é¢˜</li>
                        <li>å¼•å…¥æœºå™¨å­¦ä¹ ä¼˜åŒ–èµ·ç‚¹é€‰æ‹©</li>
                        <li>æ”¯æŒåŠ¨æ€æƒé‡å’Œå®æ—¶è·¯å†µ</li>
                        <li>å¤šç›®æ ‡ä¼˜åŒ–ï¼ˆæ—¶é—´ã€è·ç¦»ã€æˆæœ¬ï¼‰</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            securityLevel: 'loose',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#667eea',
                lineColor: '#667eea',
                secondaryColor: '#764ba2',
                tertiaryColor: '#f093fb',
                background: '#ffffff',
                mainBkg: '#ffffff',
                secondBkg: '#f8f9fa',
                tertiaryBkg: '#e8f5e8',
                cScale0: '#ff6b6b',
                cScale1: '#4ecdc4',
                cScale2: '#45b7d1',
                cScale3: '#96ceb4',
                cScale4: '#feca57'
            },
            fontFamily: 'Microsoft YaHei, Arial, sans-serif',
            fontSize: 14,
            flowchart: {
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 40,
                rankSpacing: 50,
                padding: 15
            }
        });
        
        // å¹³æ»‘æ»šåŠ¨å¯¼èˆª
        document.querySelectorAll('.nav-toc a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
