# æœ€è¿‘é‚»ç®—æ³•ä¸2-optç®—æ³•è¯¦è§£

## ç®—æ³•èƒŒæ™¯

åœ¨ä¸ªæ€§åŒ–æ—…æ¸¸ç³»ç»Ÿçš„åœ°å›¾å¯¼èˆªåŠŸèƒ½ä¸­ï¼Œå½“ç”¨æˆ·éœ€è¦ç»è¿‡å¤šä¸ªé€”å¾„ç‚¹æ—¶ï¼Œç³»ç»Ÿéœ€è¦è§£å†³**æ—…è¡Œå•†é—®é¢˜(Traveling Salesman Problem, TSP)**ã€‚TSPæ˜¯ä¸€ä¸ªç»å…¸çš„ç»„åˆä¼˜åŒ–é—®é¢˜ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°è®¿é—®æ‰€æœ‰åŸå¸‚ä¸”æ¯ä¸ªåŸå¸‚åªè®¿é—®ä¸€æ¬¡çš„æœ€çŸ­è·¯å¾„ã€‚

ç”±äºTSPæ˜¯NP-hardé—®é¢˜ï¼Œå¯¹äºå®æ—¶å¯¼èˆªç³»ç»Ÿæ¥è¯´ï¼Œéœ€è¦åœ¨è®¡ç®—æ—¶é—´å’Œè§£è´¨é‡ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚æœ¬ç³»ç»Ÿé‡‡ç”¨**æœ€è¿‘é‚»ç®—æ³•**æ„å»ºåˆå§‹è§£ï¼Œç„¶åä½¿ç”¨**2-optç®—æ³•**è¿›è¡Œå±€éƒ¨ä¼˜åŒ–ã€‚

## æœ€è¿‘é‚»ç®—æ³•(Nearest Neighbor Algorithm)

### ç®—æ³•åŸç†

æœ€è¿‘é‚»ç®—æ³•æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„è´ªå¿ƒç®—æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š
- ä»èµ·å§‹åŸå¸‚å¼€å§‹
- æ¯æ¬¡é€‰æ‹©è·ç¦»å½“å‰åŸå¸‚æœ€è¿‘çš„æœªè®¿é—®åŸå¸‚
- é‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°æ‰€æœ‰åŸå¸‚éƒ½è¢«è®¿é—®

### ç®—æ³•æµç¨‹å›¾

```mermaid
flowchart TD
    A[ğŸš€ åˆå§‹åŒ–] --> B[ğŸ“ è®¾ç½®èµ·å§‹èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹]
    B --> C[ğŸ“‹ åˆ›å»ºæœªè®¿é—®èŠ‚ç‚¹é›†åˆ]
    C --> D[â• å°†èµ·å§‹èŠ‚ç‚¹æ·»åŠ åˆ°è·¯å¾„]
    D --> E[ğŸ”„ å¼€å§‹ä¸»å¾ªç¯]
    E --> F{ğŸ“­ æœªè®¿é—®é›†åˆä¸ºç©º?}
    F -->|âœ… æ˜¯| G[ğŸ ç®—æ³•ç»“æŸï¼Œè¿”å›è·¯å¾„]
    F -->|âŒ å¦| H[ğŸ” åœ¨æœªè®¿é—®èŠ‚ç‚¹ä¸­æ‰¾æœ€è¿‘çš„]
    H --> I[ğŸ“ è®¡ç®—åˆ°å„æœªè®¿é—®èŠ‚ç‚¹çš„è·ç¦»]
    I --> J[ğŸ¯ é€‰æ‹©è·ç¦»æœ€å°çš„èŠ‚ç‚¹]
    J --> K[â• å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°è·¯å¾„]
    K --> L[âŒ ä»æœªè®¿é—®é›†åˆä¸­ç§»é™¤è¯¥èŠ‚ç‚¹]
    L --> M[ğŸ”„ æ›´æ–°å½“å‰èŠ‚ç‚¹]
    M --> E
    
    style A fill:#e8f5e8
    style F fill:#fff3e0
    style J fill:#f3e5f5
    style G fill:#ffebee
```

### ç®—æ³•å®ç°

```python
def nearest_neighbor_algorithm(start_node, nodes, distance_matrix):
    """
    æœ€è¿‘é‚»ç®—æ³•å®ç°
    
    Args:
        start_node: èµ·å§‹èŠ‚ç‚¹
        nodes: æ‰€æœ‰èŠ‚ç‚¹åˆ—è¡¨
        distance_matrix: è·ç¦»çŸ©é˜µï¼Œdistance_matrix[i][j]è¡¨ç¤ºèŠ‚ç‚¹iåˆ°èŠ‚ç‚¹jçš„è·ç¦»
    
    Returns:
        tour: è®¿é—®é¡ºåºåˆ—è¡¨
        total_distance: æ€»è·ç¦»
    """
    # åˆå§‹åŒ–
    unvisited = set(nodes) - {start_node}  # æœªè®¿é—®èŠ‚ç‚¹é›†åˆ
    tour = [start_node]                    # è·¯å¾„ä»èµ·ç‚¹å¼€å§‹
    current_node = start_node              # å½“å‰èŠ‚ç‚¹
    total_distance = 0                     # æ€»è·ç¦»
    
    # ä¸»å¾ªç¯ï¼šç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«è®¿é—®
    while unvisited:
        # æ‰¾åˆ°è·ç¦»å½“å‰èŠ‚ç‚¹æœ€è¿‘çš„æœªè®¿é—®èŠ‚ç‚¹
        nearest_node = None
        min_distance = float('inf')
        
        for node in unvisited:
            distance = distance_matrix[current_node][node]
            if distance < min_distance:
                min_distance = distance
                nearest_node = node
        
        # æ›´æ–°è·¯å¾„å’ŒçŠ¶æ€
        tour.append(nearest_node)
        unvisited.remove(nearest_node)
        total_distance += min_distance
        current_node = nearest_node
    
    return tour, total_distance
```

### ç®—æ³•åˆ†æ

**æ—¶é—´å¤æ‚åº¦ï¼š**
- å¤–å±‚å¾ªç¯ï¼šO(n) - éœ€è¦è®¿é—®nä¸ªèŠ‚ç‚¹
- å†…å±‚å¾ªç¯ï¼šO(n) - æ¯æ¬¡éœ€è¦åœ¨å‰©ä½™èŠ‚ç‚¹ä¸­æ‰¾æœ€è¿‘çš„
- æ€»ä½“å¤æ‚åº¦ï¼šO(nÂ²)

**ç©ºé—´å¤æ‚åº¦ï¼š**
- O(n) - å­˜å‚¨æœªè®¿é—®èŠ‚ç‚¹é›†åˆå’Œè·¯å¾„

**ä¼˜ç¼ºç‚¹åˆ†æï¼š**

âœ… **ä¼˜ç‚¹ï¼š**
- ç®—æ³•ç®€å•ï¼Œæ˜“äºç†è§£å’Œå®ç°
- æ—¶é—´å¤æ‚åº¦ç›¸å¯¹è¾ƒä½ï¼Œé€‚åˆå®æ—¶åº”ç”¨
- æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªå¯è¡Œè§£
- å¯¹äºæŸäº›ç‰¹æ®Šæƒ…å†µèƒ½æ‰¾åˆ°æœ€ä¼˜è§£

âŒ **ç¼ºç‚¹ï¼š**
- è´ªå¿ƒç­–ç•¥å¯èƒ½é™·å…¥å±€éƒ¨æœ€ä¼˜
- è§£çš„è´¨é‡å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºèµ·å§‹èŠ‚ç‚¹çš„é€‰æ‹©
- åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½äº§ç”Ÿè´¨é‡è¾ƒå·®çš„è§£

### å®é™…åº”ç”¨ç¤ºä¾‹

è€ƒè™‘ä¸€ä¸ªç®€å•çš„4ä¸ªåŸå¸‚çš„ä¾‹å­ï¼š

```
åŸå¸‚: A(èµ·ç‚¹), B, C, D
è·ç¦»çŸ©é˜µ:
    A  B  C  D
A   0  2  9  10
B   1  0  6  4
C   15 7  0  8
D   6  3  12 0
```

**æ‰§è¡Œè¿‡ç¨‹ï¼š**
1. ä»Aå¼€å§‹ï¼Œæœªè®¿é—®ï¼š{B, C, D}
2. Aåˆ°B=2, Aåˆ°C=9, Aåˆ°D=10ï¼Œé€‰æ‹©B (æœ€å°è·ç¦»2)
3. å½“å‰åœ¨Bï¼Œæœªè®¿é—®ï¼š{C, D}
4. Båˆ°C=6, Båˆ°D=4ï¼Œé€‰æ‹©D (æœ€å°è·ç¦»4)
5. å½“å‰åœ¨Dï¼Œæœªè®¿é—®ï¼š{C}
6. Dåˆ°C=12ï¼Œé€‰æ‹©C
7. æœ€ç»ˆè·¯å¾„ï¼šAâ†’Bâ†’Dâ†’Cï¼Œæ€»è·ç¦»=2+4+12=18

## 2-optç®—æ³•(2-opt Algorithm)

### ç®—æ³•åŸç†

2-optç®—æ³•æ˜¯ä¸€ç§å±€éƒ¨æœç´¢ä¼˜åŒ–ç®—æ³•ï¼Œé€šè¿‡**è¾¹äº¤æ¢**æ¥æ”¹å–„TSPè§£çš„è´¨é‡ã€‚ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š
- é€‰æ‹©è·¯å¾„ä¸­çš„ä¸¤æ¡è¾¹
- å°è¯•é‡æ–°è¿æ¥è¿™ä¸¤æ¡è¾¹
- å¦‚æœæ–°çš„è¿æ¥æ–¹å¼èƒ½å‡å°‘æ€»è·ç¦»ï¼Œåˆ™é‡‡ç”¨æ–°çš„è¿æ¥

### 2-optäº¤æ¢æœºåˆ¶

```mermaid
flowchart LR
    subgraph "åŸå§‹è·¯å¾„"
        A1[åŸå¸‚A] -->|è¾¹AB| B1[åŸå¸‚B]
        B1 --> C1[åŸå¸‚C]
        C1 -->|è¾¹CD| D1[åŸå¸‚D]
        D1 --> E1[åŸå¸‚E]
    end
    
    subgraph "2-optäº¤æ¢å"
        A2[åŸå¸‚A] -->|æ–°è¾¹AD| D2[åŸå¸‚D]
        D2 --> C2[åŸå¸‚C]
        C2 --> B2[åŸå¸‚B]
        B2 -->|æ–°è¾¹BE| E2[åŸå¸‚E]
    end
    
    style A1 fill:#e3f2fd
    style D1 fill:#e3f2fd
    style A2 fill:#fff3e0
    style D2 fill:#fff3e0
```

**äº¤æ¢æ•ˆæœï¼š**
- ç§»é™¤è¾¹ï¼šABå’ŒCD
- æ·»åŠ è¾¹ï¼šADå’ŒBC
- ä¸­é—´éƒ¨åˆ†è·¯å¾„æ–¹å‘åè½¬

### ç®—æ³•æµç¨‹

```mermaid
flowchart TD
    A[ğŸ¯ è¾“å…¥åˆå§‹è·¯å¾„] --> B[ğŸ”„ è®¾ç½®æ”¹è¿›æ ‡å¿— = true]
    B --> C[ğŸ” while æ”¹è¿›æ ‡å¿—ä¸ºtrue]
    C --> D[ğŸ”„ è®¾ç½®æ”¹è¿›æ ‡å¿— = false]
    D --> E[ğŸ”„ for i = 1 to n-3]
    E --> F[ğŸ”„ for j = i+1 to n-1]
    F --> G[ğŸ“ è®¡ç®—å½“å‰ä¸¤æ¡è¾¹çš„æˆæœ¬]
    G --> H[ğŸ”„ è®¡ç®—äº¤æ¢åä¸¤æ¡è¾¹çš„æˆæœ¬]
    H --> I{ğŸ’° äº¤æ¢åæˆæœ¬æ›´ä½?}
    I -->|âœ… æ˜¯| J[ğŸ”„ æ‰§è¡Œ2-optäº¤æ¢]
    I -->|âŒ å¦| K[â¡ï¸ ç»§ç»­ä¸‹ä¸€å¯¹è¾¹]
    J --> L[âœ… è®¾ç½®æ”¹è¿›æ ‡å¿— = true]
    L --> K
    K --> M{ğŸ”š å†…å±‚å¾ªç¯ç»“æŸ?}
    M -->|âŒ å¦| F
    M -->|âœ… æ˜¯| N{ğŸ”š å¤–å±‚å¾ªç¯ç»“æŸ?}
    N -->|âŒ å¦| E
    N -->|âœ… æ˜¯| O{ğŸ”„ æœ‰æ”¹è¿›?}
    O -->|âœ… æ˜¯| C
    O -->|âŒ å¦| P[ğŸ è¿”å›ä¼˜åŒ–åçš„è·¯å¾„]
    
    style A fill:#e8f5e8
    style I fill:#fff3e0
    style J fill:#f3e5f5
    style P fill:#ffebee
```

### ç®—æ³•å®ç°

```python
def two_opt_algorithm(tour, distance_matrix):
    """
    2-optç®—æ³•å®ç°
    
    Args:
        tour: åˆå§‹è·¯å¾„
        distance_matrix: è·ç¦»çŸ©é˜µ
    
    Returns:
        optimized_tour: ä¼˜åŒ–åçš„è·¯å¾„
        total_distance: ä¼˜åŒ–åçš„æ€»è·ç¦»
    """
    n = len(tour)
    improved = True
    
    while improved:
        improved = False
        
        # éå†æ‰€æœ‰å¯èƒ½çš„è¾¹å¯¹
        for i in range(1, n - 2):
            for j in range(i + 1, n):
                if j == n - 1:  # é¿å…å¤„ç†æœ€åä¸€æ¡å›åˆ°èµ·ç‚¹çš„è¾¹
                    continue
                
                # è®¡ç®—å½“å‰ä¸¤æ¡è¾¹çš„æˆæœ¬
                current_cost = (
                    distance_matrix[tour[i-1]][tour[i]] +
                    distance_matrix[tour[j]][tour[j+1]]
                )
                
                # è®¡ç®—äº¤æ¢åä¸¤æ¡è¾¹çš„æˆæœ¬
                new_cost = (
                    distance_matrix[tour[i-1]][tour[j]] +
                    distance_matrix[tour[i]][tour[j+1]]
                )
                
                # å¦‚æœäº¤æ¢èƒ½é™ä½æˆæœ¬ï¼Œåˆ™æ‰§è¡Œäº¤æ¢
                if new_cost < current_cost:
                    # æ‰§è¡Œ2-optäº¤æ¢ï¼šåè½¬å­åºåˆ—tour[i:j+1]
                    tour[i:j+1] = reversed(tour[i:j+1])
                    improved = True
    
    # è®¡ç®—æœ€ç»ˆæ€»è·ç¦»
    total_distance = 0
    for i in range(len(tour) - 1):
        total_distance += distance_matrix[tour[i]][tour[i+1]]
    
    return tour, total_distance
```

### ç®—æ³•åˆ†æ

**æ—¶é—´å¤æ‚åº¦ï¼š**
- å¤–å±‚whileå¾ªç¯ï¼šå–å†³äºæ”¶æ•›é€Ÿåº¦ï¼Œé€šå¸¸ä¸ºO(1)åˆ°O(n)
- åŒé‡forå¾ªç¯ï¼šO(nÂ²)
- æ€»ä½“å¤æ‚åº¦ï¼šO(nÂ²k)ï¼Œå…¶ä¸­kä¸ºè¿­ä»£æ¬¡æ•°

**ç©ºé—´å¤æ‚åº¦ï¼š**
- O(1) - åŸåœ°äº¤æ¢ï¼Œä¸éœ€è¦é¢å¤–ç©ºé—´

**æ”¶æ•›æ€§ï¼š**
- ä¿è¯æ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜è§£
- æ¯æ¬¡æ”¹è¿›éƒ½ä¼šå‡å°‘æ€»è·ç¦»
- å½“æ²¡æœ‰æ›´å¤šæ”¹è¿›æ—¶ç®—æ³•ç»ˆæ­¢

### å®é™…åº”ç”¨ç¤ºä¾‹

ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„ä¾‹å­ï¼Œå‡è®¾æœ€è¿‘é‚»ç®—æ³•å¾—åˆ°è·¯å¾„ï¼šAâ†’Bâ†’Dâ†’Câ†’A

**è·ç¦»è®¡ç®—ï¼š**
- Aâ†’B: 2
- Bâ†’D: 4  
- Dâ†’C: 12
- Câ†’A: 15
- æ€»è·ç¦»: 33

**2-optä¼˜åŒ–è¿‡ç¨‹ï¼š**

å°è¯•äº¤æ¢è¾¹(A,B)å’Œ(D,C)ï¼š
- åŸå§‹ï¼šA-B + D-C = 2 + 12 = 14
- äº¤æ¢ï¼šA-D + B-C = 10 + 7 = 17
- 17 > 14ï¼Œä¸æ”¹è¿›

å°è¯•äº¤æ¢è¾¹(B,D)å’Œ(C,A)ï¼š
- åŸå§‹ï¼šB-D + C-A = 4 + 15 = 19
- äº¤æ¢ï¼šB-C + D-A = 7 + 6 = 13
- 13 < 19ï¼Œæ‰§è¡Œäº¤æ¢ï¼

**äº¤æ¢åè·¯å¾„ï¼š**Aâ†’Bâ†’Câ†’Dâ†’A
**æ–°çš„æ€»è·ç¦»ï¼š**2 + 7 + 8 + 6 = 23 < 33

## ç»„åˆåº”ç”¨åœ¨æ—…æ¸¸ç³»ç»Ÿä¸­çš„ä¼˜åŠ¿

### 1. ç®—æ³•äº’è¡¥æ€§
- **æœ€è¿‘é‚»ç®—æ³•**ï¼šå¿«é€Ÿç”Ÿæˆå¯è¡Œè§£ï¼Œä¸º2-optæä¾›è‰¯å¥½èµ·ç‚¹
- **2-optç®—æ³•**ï¼šåœ¨å¯è¡Œè§£åŸºç¡€ä¸Šè¿›è¡Œç²¾ç»†ä¼˜åŒ–

### 2. å®æ—¶æ€§å¹³è¡¡
- ä¸¤ä¸ªç®—æ³•éƒ½æ˜¯O(nÂ²)å¤æ‚åº¦ï¼Œé€‚åˆå®æ—¶å¯¼èˆªéœ€æ±‚
- åœ¨å°è§„æ¨¡é€”å¾„ç‚¹(é€šå¸¸â‰¤10ä¸ª)æƒ…å†µä¸‹å“åº”è¿…é€Ÿ

### 3. è§£è´¨é‡ä¿è¯
- æœ€è¿‘é‚»æä¾›åŸºç¡€è§£ï¼Œ2-optæä¾›å±€éƒ¨æœ€ä¼˜è§£
- ç»„åˆä½¿ç”¨é€šå¸¸èƒ½å¾—åˆ°è´¨é‡è¾ƒå¥½çš„è¿‘ä¼¼æœ€ä¼˜è§£

### 4. å®ç°ç®€å•æ€§
- ç®—æ³•é€»è¾‘æ¸…æ™°ï¼Œä¾¿äºç†è§£å’Œè°ƒè¯•
- ä¸éœ€è¦å¤æ‚çš„æ•°æ®ç»“æ„æ”¯æŒ

## æ€§èƒ½å¯¹æ¯”åˆ†æ

| ç®—æ³•ç‰¹æ€§ | æœ€è¿‘é‚»ç®—æ³• | 2-optç®—æ³• | ç»„åˆç®—æ³• |
|---------|-----------|-----------|----------|
| æ—¶é—´å¤æ‚åº¦ | O(nÂ²) | O(nÂ²k) | O(nÂ²(1+k)) |
| ç©ºé—´å¤æ‚åº¦ | O(n) | O(1) | O(n) |
| è§£è´¨é‡ | ä¸­ç­‰ | å±€éƒ¨æœ€ä¼˜ | è¾ƒå¥½ |
| å®ç°éš¾åº¦ | ç®€å• | ä¸­ç­‰ | ä¸­ç­‰ |
| é€‚ç”¨åœºæ™¯ | å¿«é€Ÿåˆå§‹è§£ | è§£ä¼˜åŒ– | å®æ—¶å¯¼èˆª |

## æ€»ç»“

åœ¨ä¸ªæ€§åŒ–æ—…æ¸¸ç³»ç»Ÿä¸­ï¼Œæœ€è¿‘é‚»ç®—æ³•ä¸2-optç®—æ³•çš„ç»„åˆæä¾›äº†ä¸€ä¸ªé«˜æ•ˆã€å®ç”¨çš„å¤šç‚¹è·¯å¾„è§„åˆ’è§£å†³æ–¹æ¡ˆï¼š

1. **æœ€è¿‘é‚»ç®—æ³•**è´Ÿè´£å¿«é€Ÿæ„å»ºåˆå§‹å¯è¡Œè§£
2. **2-optç®—æ³•**è´Ÿè´£ä¼˜åŒ–è§£çš„è´¨é‡
3. ä¸¤è€…ç»“åˆåœ¨è®¡ç®—æ•ˆç‡å’Œè§£è´¨é‡ä¹‹é—´è¾¾åˆ°äº†è‰¯å¥½å¹³è¡¡
4. é€‚åˆå®æ—¶å¯¼èˆªç³»ç»Ÿçš„å“åº”éœ€æ±‚

è¿™ç§ç»„åˆæ–¹æ³•è™½ç„¶ä¸èƒ½ä¿è¯æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­èƒ½å¤Ÿæä¾›è´¨é‡è¾ƒé«˜çš„è¿‘ä¼¼è§£ï¼Œæ»¡è¶³ç”¨æˆ·çš„å¯¼èˆªéœ€æ±‚ã€‚
